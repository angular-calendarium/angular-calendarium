!function(){"use strict";var a=['<div class="calendarium-container">','<div class="calendarium" ng-hide="loading">','<div class="header">','<div class="container">','<button class="previous" ng-click="previousMonth()" title="previous month" ><</button>',"<div>{{monthLabel}} / {{yearLabel}}</div>",'<button class="next" ng-click="nextMonth()" title="next month">></button>',"</div>","</div>",'<ol class="calendarium-day-names">','<li ng-repeat="weekDay in weekDays">{{weekDay[day_label]}}</li>',"</o>",'<ol class="calendarium-days">','<li ng-repeat="dateContainer in dateContainers" title="{{dateContainer.state.tooltip}}">','<div ng-if="dateContainer.state.disabled" class="date disabled" ng-class="dateContainer.state.className">{{dateContainer.date.getDate()}}</div>','<div ng-if="!dateContainer.state.disabled && !isDate(dateContainer.date)" class="date empty"></div>','<div ng-if="!dateContainer.state.disabled && isDate(dateContainer.date)" ng-class="dateContainer.state.className" class="date" ng-click="selectDate(dateContainer.date,dateContainer.state)">{{dateContainer.date.getDate()}}</div>',"</li>","</ol>","</div>",'<div class="showbox" ng-show="loading">','<div class="loading">',"loading...","</div>","</div>","<div>"].join("");angular.module("ngCalendarium",[]).constant("calendarConfig",{template:a,default_day_label:"abbr",day_labels:[{full:"Sunday",day:"Sun",abbr:"S"},{full:"Monday",day:"Mon",abbr:"M"},{full:"Tuesday",day:"Tue",abbr:"T"},{full:"Wednesday",day:"Wed",abbr:"W"},{full:"Thursday",day:"Thu",abbr:"T"},{full:"Friday",day:"Fri",abbr:"F"},{full:"Saturday",day:"Sat",abbr:"S"}],month_labels:["January","February","March","April","May","June","July","August","September","October","November","December"],days_in_month:[31,28,31,30,31,30,31,31,30,31,30,31]}).factory("_",["$window",function(a){return a._}]).service("calendariumService",["calendarConfig","$http","$q",function(a,e,t){var n=this;n.getDateIntervals=function(e,t){var n,r,i=new Date(e,t,1),d=[];r=a.days_in_month[t],1===t&&(e%4===0&&e%100!==0||e%400===0)&&(r+=1);for(var l=1;r>=l;l++)d.push(l);return n=new Date(e,t,d.length),{firstWeekDate:i.getDay(),firstDate:i,lastDate:n,days:d}},n.loadCalendarDates=function(a,r,i,d){var l=t.defer();if(!a)return l.resolve(n.getDateIntervals(r,i)),l.promise();var s=n.getDateIntervals(r,i);return e({url:a,method:"GET",params:angular.extend({firstDate:s.firstDate.toISOString(),lastDate:s.lastDate.toISOString()},d||{})}).then(function(a){var e=angular.extend({dates:a.data},s);return e},function(a){throw a})}}]).directive("calendarium",["$parse","calendarConfig","calendariumService","_",function(a,e,t,n){return{restrict:"E",replace:!0,scope:{month:"@",year:"@",onDateSelected:"&",url:"@",params:"="},template:e.template,link:function(a){var r=a.onDateSelected();a._year=null===a.year||isNaN(a.year)?(new Date).getFullYear():a.year,a._month=null===a.month||isNaN(a.month)?(new Date).getMonth():a.month,a.weekDays=e.day_labels,a.day_label=e.default_day_label,a.isDate=function(a){return a instanceof Date},a.selectDate=function(a,e){r&&r(a,e)},a.previousMonth=function(){0===a._month?(a._month=11,a._year=a._year-1):a._month=a._month-1,a.render()},a.nextMonth=function(){11===a._month?(a._month=0,a._year=a._year+1):a._month=a._month+1,a.render()},a.render=function(){a.loading=!0,t.loadCalendarDates(a.url,a._year,a._month,a.params).then(function(t){if(a.monthLabel=e.month_labels[t.firstDate.getMonth()],a.yearLabel=t.firstDate.getFullYear(),a.dateContainers=[],n.each(t.days,function(e){var r={date:new Date(t.firstDate.getFullYear(),t.firstDate.getMonth(),e),state:n.findWhere(t.dates,{day:e})||{disabled:!1}};a.dateContainers.push(r)}),0!==t.firstDate.getDay())for(var r=0;r<t.firstDate.getDay();r++)a.dateContainers.unshift({date:r,state:{disabled:!1}});if(a.dateContainers.length%7!==0)for(var i=a.dateContainers.length%7,d=0;7-i>d;d++)a.dateContainers.push({date:d,state:{disabled:!1}});a.loading=!1},function(e){throw a.loading=!1,e})},a.render()}}}])}();